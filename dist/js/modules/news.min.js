class News{constructor(e){let t=this.newsSection=document.querySelector(e),s=this.newsContainer=t.querySelector(".container"),n=this.glob=this,o=this.newsBtn=document.createElement("button");o.classList.add("button","button-o","news-button"),o.innerText="Все новости";let a=this.lim=3,l=this.from=0;localStorage.setItem("test",JSON.stringify(a));let c=this.newsRow=document.createElement("div");c.classList.add("row");let i=new XMLHttpRequest;i.open("GET",`https://cargochina.herokuapp.com/news/${l}/${a}`),i.setRequestHeader("Content-type","application/json; charset = utf-8"),i.send(),i.addEventListener("readystatechange",(function(){if(i.readyState<4);else if(4===i.readyState&&200===i.status){let e=JSON.parse(i.response);for(let t=0;t<e.length;t++)c.append(n.createNews(e[t]))}else console.log("Ошибка")})),t.contains(s)?(s.append(o),o.before(c)):console.log(!1),o.addEventListener("click",()=>n.showNews(n))}createNews(e){let t=document.createElement("div");t.classList.add("col-10","offset-1","col-sm-8","offset-sm-2","col-md-4","offset-md-0");let s;s=null!==e.img?e.img:"https://via.placeholder.com/350x200";let n=new Date(Date.parse(e.date)),o=document.createElement("div");return o.classList.add("news-block"),o.innerHTML=`  <div class="news-block__img">\n                           <img src= ${s} alt= ${e.title}>\n                       </div>\n    \n                       <div class="news-block__content">\n    \n                           <div class="news-block__date">\n                               <span class="news-block__day">${n.getDate()}</span>\n                               <span class="news-block__month">${["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"][n.getMonth()]}</span>\n                           </div>\n                           \x3c!-- /.news-block__date --\x3e\n    \n                           <div class="news-block__text">\n                               <h3 class="news-block__title">${e.title}</h3>\n    \n                               <p class="news-block__descr">\n                                   ${e.text}\n                               </p>\n                               \x3c!-- /.news-block__descr --\x3e\n                           </div>\n                           \x3c!-- /.news-block__text --\x3e\n                       </div>\n                       \x3c!-- /.news-block__content --\x3e`,t.append(o),t}showNews(e){let t=e,s=new XMLHttpRequest;s.open("GET","https://cargochina.herokuapp.com/news"),s.setRequestHeader("Content-type","application/json; charset = utf-8"),s.send(),s.addEventListener("readystatechange",(function(){if(s.readyState<4);else if(4===s.readyState&&200===s.status){let e,n=JSON.parse(s.response);for(let t in n[0])e=n[0][t];if(t.from=localStorage.getItem("test"),t.from<e){t.lim=1;let e=new XMLHttpRequest;e.open("GET",`https://cargochina.herokuapp.com/news/${t.from}/${t.lim}`),e.setRequestHeader("Content-type","application/json; charset = utf-8"),e.send(),e.addEventListener("readystatechange",(function(){if(e.readyState<4);else if(4===e.readyState&&200===e.status){let s=JSON.parse(e.response);for(let e=0;e<s.length;e++)t.newsRow.append(t.createNews(s[e]))}else console.log("Ошибка");t.lim++,t.from++,localStorage.setItem("test",JSON.stringify(t.from))}))}else t.lim=0,console.log(t.from),t.newsBtn.hidden=!0}else console.log("Ошибка")}))}}