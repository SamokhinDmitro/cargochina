document.addEventListener("DOMContentLoaded",()=>{let e=document.forms.calculationForm;function t(){"none"!==this.value&&this.value.trim()?this.style.border="1px solid green":("form__custom-select"===this.className&&(this.previousElementSibling.querySelector("[data-select-title]").style.border="2px solid red"),this.style.border="1px solid red",this.value="")}function o(e){e.preventDefault();let t={};for(let e in this.elements)this.elements.hasOwnProperty(e)&&this.elements[e].name&&(t[this.elements[e].name]=this.elements[e].value);!function(e){for(let t=0;t<e.elements.length;t++)"form__custom-select"===e.elements[t].className&&(e.elements[t].previousElementSibling.querySelector("[data-select-title]").textContent="Выберите из списка",e.elements[t].previousElementSibling.querySelector("[data-select-title]").style.border="1px solid #c1c4c7"),e.elements[t].value="",e.elements[t].style.border="1px solid #c1c4c7"}(this);let o={modelName:"InternetDocument",calledMethod:"getDocumentPrice",methodProperties:{CitySender:t["cargo-city-from"],CityRecipient:t["cargo-city-to"],Weight:t["cargo-weight"],ServiceType:t["cargo-option"],Cost:"100",CargoType:t["cargo-type"],OptionsSeat:[{volumetricVolume:t["cargo-volume"],volumetricWidth:t["cargo-width"],volumetricLength:t["cargo-length"],volumetricHeight:t["cargo-height"],weight:t["cargo-weight"]}],SeatsAmount:"1"},apiKey:n},s=new XMLHttpRequest;s.open("POST","https://api.novaposhta.ua/v2.0/json/"),s.setRequestHeader("Content-type","application/json; charset = utf-8"),s.send(JSON.stringify(o)),s.addEventListener("readystatechange",(function(){if(s.readyState<4);else if(4===s.readyState&&200===s.status){let e=JSON.parse(s.response);for(let t=0;t<e.data.length;t++){console.log(e.data[t].Cost),console.log(e.data[t]),(new Popup).showPopup("#popup-result",e.data[t].Cost);break}}else console.log("Что то пошло не так")}))}document.querySelectorAll("[data-select]").forEach(e=>{e.setAttribute("tabindex",0),e.querySelector(".form-select__dropdown").style.overflowY="scroll",e.addEventListener("click",(function(e){const t=this.nextElementSibling;if(e.target.hasAttribute("data-select-item")){let o=e.target.getAttribute("data-select-item");this.querySelector("[data-select-title]").textContent=e.target.textContent,this.querySelector(".form-select__dropdown").classList.toggle("hidden"),t.value=o}else this.querySelector(".form-select__dropdown").classList.toggle("hidden")}))}),function(e){for(let o=0;o<e.elements.length;o++)"form__custom-select"===e.elements[o].className&&e.elements[o].previousElementSibling.hasAttribute("data-select")&&e.elements[o].previousElementSibling.addEventListener("blur",(function(){"none"!==e.elements[o].value?this.querySelector("[data-select-title]").style.border="2px solid green":this.querySelector("[data-select-title]").style.border="2px solid red"})),"button"!==e.elements[o].type&&"submit"!==e.elements[o].type&&(e.elements[o].setAttribute("required","required"),e.elements[o].addEventListener("blur",t));e.addEventListener("submit",o)}(e);let n="912d257222b0cb87a01f72c6ccd05cf2";i(e.elements["cargo-type"],{modelName:"Common",calledMethod:"getCargoTypes",methodProperties:{},apiKey:n});i(e.elements["cargo-option"],{modelName:"Common",calledMethod:"getServiceTypes",apiKey:n,methodProperties:{}});let s=e.elements["cargo-city-to"],l=e.elements["cargo-city-from"];function i(e,t,o="https://api.novaposhta.ua/v2.0/json/"){let n=new XMLHttpRequest;n.open("POST",o),n.setRequestHeader("Content-type","application/json; charset = utf-8"),n.send(JSON.stringify(t)),n.addEventListener("readystatechange",(function(){if(n.readyState<4);else if(4===n.readyState&&200===n.status){let t=JSON.parse(n.response);for(let o=0;o<t.data.length;o++)r(t.data[o]),e.append(r(t.data[o]));if(e.previousElementSibling.hasAttribute("data-select")){let o=e.previousElementSibling.querySelector(".form-select__dropdown");for(let e=0;e<t.data.length;e++)a(t.data[e]),o.append(a(t.data[e]))}}else console.log("Что то пошло не так")}))}function r(e){let t=document.createElement("option");return t.value=e.Ref,t.textContent=e.Description,t}function a(e){let t=document.createElement("div");return t.classList.add("form-select__item"),t.setAttribute("data-select-item",e.Ref),t.textContent=e.Description,t}function c(e,t){if(null!==localStorage.getItem(e)){let o=JSON.parse(localStorage.getItem(e));for(let e=0;e<o.length;e++)r(o[e]),t.append(r(o[e]));if(t.previousElementSibling.hasAttribute("data-select")){let e=t.previousElementSibling.querySelector(".form-select__dropdown");e.overflowY="scroll";for(let t=0;t<o.length;t++)a(o[t]),e.append(a(o[t]))}let n=t.previousElementSibling.querySelector("[data-select-title]");n.setAttribute("contenteditable",!0),n.addEventListener("focus",(function(){this.textContent=""})),n.addEventListener("input",(function(){t.previousElementSibling.querySelector(".form-select__dropdown").classList.remove("hidden");let e=this.textContent.trim().toLowerCase(),o=t.previousElementSibling.querySelectorAll(".form-select__item");""!=e?o.forEach((function(t){-1==t.textContent.toLowerCase().search(e)?t.classList.add("hidden"):t.classList.remove("hidden")})):o.forEach((function(e){e.classList.remove("hidden")}))}))}}c("Mycity",s),c("Mycity",l),void 0===function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}("cities")&&function(){let e=new Date;e=new Date(e.setDate(e.getDate()+1));let t={modelName:"Address",calledMethod:"getCities",methodProperties:{},apiKey:n},o=new XMLHttpRequest;o.open("POST","https://api.novaposhta.ua/v2.0/json/"),o.setRequestHeader("Content-type","application/json; charset = utf-8"),o.send(JSON.stringify(t)),o.addEventListener("readystatechange",(function(){if(o.readyState<4);else if(4===o.readyState&&200===o.status){let e=[],t={},n=JSON.parse(o.response);for(let o=0;o<n.data.length;o++)t={Ref:n.data[o].Ref,Description:n.data[o].Description},e.push(t);localStorage.setItem("Mycity",JSON.stringify(e))}else console.log("Что то пошло не так")})),document.cookie=`${decodeURI("cities")} = ${decodeURI(!0)}; expires = ${e}; path = /`}()});